# 概述

字符串是每种语言都支持的字面量，通常是一种不可变类型。

> 跟Java一样，Python的字符串也是不可变的。但是，对于Java而言，字符串是由字符组成的；而Python没有字符类型，可以认为长度为1的字符串就是一个字符。

# 定义

不同语言对字符串字面量的定义方式都大同小异，基本上也就是定界符不一样。

Python应该算是笔者见过的字符串表现形式最多样化的语言了，没有之一。

定界符可以是单引号、双引号，甚至是三引号（即3个引号，这里的引号既可以是单引号又可以是双引号）。比如：

```python
single_quotation_mark = '单引号字符串'
double_quotation_mark = "双引号字符串"
trible_single_quotation_mark = '''三单引号
长字符串，可以跨行'''
trible_double_quotation_mark = """三双引号
长字符串，也可以跨行"""
```

## 长字符串

用3个引号括起来的字符串，就称为“长字符串”。如上示例所示，长字符串是可以换行的。

三引号之间的所有引号、制表符或换行都被认为是字符串的一部分。

> 注意，长字符串换行后不需要保持代码块的缩进，否则，新行的开头会保留用以缩进的空格或制表符，这通常不是你想要的。

## 原始字符串

对于一些特殊字符而言，如果想在字符串中原样输出它们就需要通过转义，Python的转义前缀跟Java一样，也是反斜杠（\）。

```python
escape_str = 'this is a \'escape\' string'
# this is a 'escape' string
```

因此，如果要输出反斜杠就要写两个反斜杠，比如：

```python
escape_file_path = 'C:\\python\\test'
# C:\python\test
```

可见，在一个长路径中将充斥大量的转义反斜杠，这时，就可以使用原始字符串。所谓“原始字符串”，就是字符串前加一个“r”字符的字符串，它完全忽略所有的转义字符，打印出字符串中所有的反斜杠。比如：

```python
raw_str = r'C:\python\test'
# 跟上一示例中的路径等价
```

这里需要意识到，原始字符串与长字符串是不排斥的，可以混用。

另外，需要理解“忽略转义字符”的涵意，即形式上看，首先原始字符串包含的转义字符都是合法的。那什么时候转义不合法呢？就是反斜杠后没有其他字符了。简单说，就是以单个反斜杠结尾。因此，给出的路径不应是反斜杠结尾的文件夹。如果的确是这样的情况，一个技巧是：将结尾反斜杠之外的部分写为原始字符串，再拼接一个转义的反斜杠。

# 运算符

## 加号（+）和拼接

跟Java一样，加号针对字符串进行了重载，用于拼接字符串。

Python更灵活的一点是，可以不使用加号，而仅仅是把一系列字符串排列在一起，就能将它们自动拼接在一起，比如：

```python
auto_contact = 'auto ' 'contact ' 'string'
# 'auto contact string'
```

## 乘号（*）和复制

在Python中，乘号被重载为复制字符串的运算符，将一个字符串通过乘号与整数n进行运算，结果字符串即为原字符串重复n次所得。比如：

```python
single_str = 'single'
multi_str = single_str * 3
# 'singlesinglesingle'
```

## 格式设置运算符（%）

```python
format_str % values
```

```python
'Hello, %s' % 'World'
```

# 其他操作

## 序列操作

Python中的字符串是一种序列类型，因此可以进行一些序列操作。比如：访问元素、切片等等。

```python
# 甚至可以对字符串字面量进行操作
'Eric Zong'[:4]
'Eric Zong'[0]
```

但是，由于字符串是不可变的，所以，试图修改它的序列操作是非法的。比如如下的索引或切片赋值就是非法的：

```python
mystr = 'this is a normal string'
# 非法，试图给字符串中某个字符赋值
mystr[0] = 'T'
# 非法，试图给字符串切片赋值
mystr[:4] = 'that'
```

## 格式化

1. 格式设置运算符（%）；
2. 模板字符串（Template），类似于UNIX shell语法；
3. 字符串format方法。
4. 变量同名替换。

格式设置运算符操作的格式字符串中占位符以“%”作为前缀，被称为“转换说明符”，比如：%s等。

模板字符串中的点位符以“$”作为前缀。

```python
from string import Template
tmpl = Template('Hello, $who!')
tmpl.substitute(who='World')
```

format方法中的格式字符串中替换字段（占位符）用一对花括号括起来。其中的包括：字段名、转换标志、格式说明符。字段名可以是：

1. 无， 未命名字段，用未命名参数替换；
2. 索引，从0；
3. 命名字段，用命名参数替换。

```python
# 顺序引用
'{}, {}'.format('Hello', 'World')
# 按索引引用
'{1}, {0}'.format('World', 'Hello')
# 按名称引用
'Hello, {name}'.format(name='World')
```

> 未命名字段和命名字段可以混合使用，但手工编号（命名字段）和自动编号（未命名字段）不能混合使用。

变量同名替换的占位符跟format方法名称引用的占位符一样，只是它被直接用在f字符串中。

```python
name = 'World'
f'Hello, {name}'
```

