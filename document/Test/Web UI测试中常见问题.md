# 不唯一的 id

通常而言，因尽可能使用 id 查找，因为其效率是最高的，且不会因为页面结构的改变而需要重新修正。

但是，id 查找常见的问题是，id 不是全局唯一的。这种情况下，很可能查找到的元素不是期望的，并且通常还不会报错。因此，导致的问题也通常很隐晦。

对于目前众多的前端框架而言，出现这个问题的一个典型场景是在“弹出对话框”中。目前“弹出对话框”常以 div 模拟，因此，它仍属于原页面。但是，其中的 id 可能与主页面中的某个 id 相同。

要确认是否有重复 id，直接搜索页面源码即可。

严格来说，这是一个与规范相关的 Bug，理应报给前端开发人员修正。暂时规避的方法是，通过添加上层容器的选择器来限制查找范围。

# 会改变的 id

有时，虽然元素有 id，但是，通过 id 查找总会失败。因为，元素的 id 是由框架生成的，每次加载都会生成不同的 id。

典型场景是在 ExtJS 开发的页面中。

这个问题很容易排查。

解决方法，要么要求前端给出固定的 id，要么使用更为复杂的选择器。

# 包含特殊符号的 id

id 选择器可能是：`#/normal/path/$word`，其中包含有特殊符号 / 和 $。

使用该 id 选择器的原始文本通常是查找不到元素的，而在 Chrome 源码查找（开发者工具→Elements标签页→Ctrl+F）中，需要使用反斜杠（\）转义特殊字符——`#\/normal\/path\/\$word`。

但是，转义后的 id 选择器在某些测试框架下不一定能找到元素，比如 puppeteer 就不行。

一种解决方案是将 id 选择器改写为属性选择器——`[id="/normal/path/$word"]`（注意：属性值中的特殊字符不需要转义）。